<!doctype html>
<html lang="da">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Jarvis Admin</title>
    <link rel="icon" href="/static/favicon.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="/static/styles.css" />
    <link rel="stylesheet" href="/static/app.css?v=23" />
  </head>
<body>
  <header class="topbar">
    <div class="brand">
      <h1>Admin</h1>
      <span class="pill">Jarvis</span>
      <span id="statusBadge" class="status">Klar</span>
    </div>
          <meta name="viewport" content="width=device-width, initial-scale=1" />
          <title>Jarvis Admin</title>
          <link rel="icon" href="/static/favicon.svg" type="image/svg+xml" />
          <link rel="stylesheet" href="/static/styles.css" />
          <link rel="stylesheet" href="/static/app.css?v=23" />
        </head>
  <main class="shell admin-shell">
    <aside class="sidebar admin-sidebar">
      <div class="sidebar-header">
        <div class="rail-logo">
          <span class="logo-short">J</span>
          <span class="logo-long">Jarvis</span>
        </div>
        <div class="rail-row">
          <button id="collapseBtn" class="rail-btn" title="Skjul sidebar" aria-label="Skjul sidebar">≡</button>
        </div>
      </div>
      <div class="session-list">
        <div class="session-group-title">Admin</div>
        <div class="session-item admin-nav-item" data-target="panel-create-user">
          <div class="session-name">Opret bruger</div>
        </div>
        <div class="session-item admin-nav-item active" data-target="panel-users">
          <div class="session-name">Brugere</div>
        </div>
        <div class="session-item admin-nav-item" data-target="panel-sessions">
          <div class="session-name">Sessions</div>
        </div>
        <div class="session-item admin-nav-item" data-target="panel-settings">
          <div class="session-name">Indstillinger</div>
        </div>
        <div class="session-item admin-nav-item" data-target="panel-tickets">
          <div class="session-name">Tickets</div>
        </div>
        <div class="session-item admin-nav-item" data-target="panel-logs">
          <div class="session-name">Logs</div>
        </div>
      </div>
      <div class="sidebar-footer">
        <div class="small admin-status">
          <span class="status-dot" id="adminStatusDot"></span>
          <span id="adminStatusText">Jarvis online</span>
        </div>
        <a id="backBtn" class="rail-btn rail-wide" href="/app" title="Til chat" aria-label="Til chat">
          <span class="rail-icon">↩</span>
          <span class="rail-label">Til Jarvis</span>
        </a>
        <button id="logoutBtn" class="rail-btn rail-wide" title="Log ud" aria-label="Log ud">
          <span class="rail-icon">⏻</span>
          <span class="rail-label">Log ud</span>
        </button>
      </div>
    </aside>

    <section class="chat-pane admin-content">
      <div class="admin-grid">
        <section class="card" id="panel-create-user">
          <h2>Opret bruger</h2>
          <label>Brugernavn</label>
          <input id="createUsername" placeholder="ny bruger" />
          <label>Email</label>
          <input id="createEmail" placeholder="email@domæne.dk" />
          <label>Navn</label>
          <input id="createFullName" placeholder="Fulde navn" />
          <label>Efternavn</label>
          <input id="createLastName" placeholder="Efternavn" />
          <label>By</label>
          <input id="createCity" placeholder="By" />
          <label>Password</label>
          <input id="createPassword" type="password" placeholder="••••••" />
          <label>Telefon</label>
          <input id="createPhone" placeholder="telefon" />
          <label>Note</label>
          <input id="createNote" placeholder="note" />
          <label class="inline" style="margin-top: 8px;">
            <input id="createIsAdmin" type="checkbox" />
            Admin
          </label>
          <button id="createUserBtn" class="secondary" style="margin-top: 8px;">Opret bruger</button>
          <div class="small" id="createUserStatus"></div>
        </section>

        <section class="card" id="panel-online-users">
          <h2>Brugere online</h2>
          <div id="onlineUsers"></div>
        </section>

        <section class="card" id="panel-users">
          <div class="card-row">
            <h2>Brugere</h2>
            <input id="userSearch" placeholder="Søg bruger..." />
          </div>
          <div id="users"></div>
          <div class="small">Viser de 5 nyeste brugere.</div>
        </section>

        <section class="card" id="panel-sessions">
          <div class="card-row">
            <h2>Sessions</h2>
            <input id="sessionSearchAdmin" placeholder="Søg session..." />
          </div>
          <label>Bruger</label>
          <input id="sessionUser" placeholder="brugernavn (tom = dig)" />
          <button id="loadSessionsBtn" class="secondary" style="margin-top: 8px;">Hent sessions</button>
          <div id="sessions"></div>
        </section>

        <section class="card" id="panel-user-detail">
          <h2>Brugerprofil</h2>
          <div class="detail-grid">
            <div>
              <label>ID</label>
              <input id="detailId" disabled />
            </div>
            <div>
              <label>Brugernavn</label>
              <input id="detailUsername" disabled />
            </div>
            <div>
              <label>Email</label>
              <input id="detailEmail" />
            </div>
            <div>
              <label>Navn</label>
              <input id="detailFullName" />
            </div>
            <div>
              <label>By</label>
              <input id="detailCity" />
            </div>
            <div>
              <label>Efternavn</label>
              <input id="detailLastName" />
            </div>
            <div>
              <label>Telefon</label>
              <input id="detailPhone" />
            </div>
            <div>
              <label>Note</label>
              <input id="detailNote" />
            </div>
            <div>
              <label>Oprettet</label>
              <input id="detailCreated" disabled />
            </div>
            <div>
              <label>Sidst set</label>
              <input id="detailLastSeen" disabled />
            </div>
            <div>
              <label>Maanedlig quota (MB)</label>
              <input id="detailQuotaLimit" type="number" min="0" />
            </div>
            <div>
              <label>Credits (MB)</label>
              <input id="detailQuotaCredits" type="number" min="0" />
            </div>
            <div>
              <label>Password hash</label>
              <input id="detailHash" disabled />
            </div>
            <div>
              <label>Nyt password</label>
              <input id="detailNewPassword" type="password" />
            </div>
          </div>
          <button id="saveUserDetailBtn" class="secondary" style="margin-top: 8px;">Gem ændringer</button>
          <div class="small" id="detailStatus"></div>
        </section>

        <section class="card" id="panel-settings">
          <h2>Indstillinger</h2>
          <label>Footer tekst</label>
          <input id="footerTextInput" placeholder="Jarvis v.1 - 2026" />
          <label>Support link</label>
          <input id="footerSupportInput" placeholder="https://..." />
          <label>Kontakt link</label>
          <input id="footerContactInput" placeholder="https://..." />
          <label>Licens tekst</label>
          <input id="footerLicenseTextInput" placeholder="Open‑source licens" />
          <label>Licens link</label>
          <input id="footerLicenseUrlInput" placeholder="https://..." />
          <label class="inline" style="margin-top: 8px;">
            <input id="registerEnabledInput" type="checkbox" />
            Tillad registrering på login
          </label>
          <label class="inline" style="margin-top: 6px;">
            <input id="captchaEnabledInput" type="checkbox" />
            Slå captcha til
          </label>
          <label class="inline" style="margin-top: 6px;">
            <input id="googleAuthEnabledInput" type="checkbox" />
            Slå Google login til
          </label>
          <label class="inline" style="margin-top: 6px;">
            <input id="maintenanceEnabledInput" type="checkbox" />
            Vedligeholdelse (luk for brugere)
          </label>
          <label style="margin-top: 6px;">Vedligeholdelsesbesked</label>
          <input id="maintenanceMessageInput" placeholder="Jarvis er i vedligeholdelse..." />
          <label style="margin-top: 8px;">Personlighed (SYSTEM_PROMPT)</label>
          <textarea id="systemPromptInput" rows="6" placeholder="SYSTEM_PROMPT..."></textarea>
          <label style="margin-top: 8px;">Opdateringslog</label>
          <textarea id="updatesLogInput" rows="4" placeholder="Seneste opdateringer..."></textarea>
          <label style="margin-top: 8px;">Standard quota (MB)</label>
          <input id="quotaDefaultInput" type="number" min="0" />
          <label style="margin-top: 8px;">Navn i topbar</label>
          <input id="brandTopInput" placeholder="Jarvis" />
          <label style="margin-top: 8px;">Navn i sidebar + status</label>
          <input id="brandCoreInput" placeholder="Jarvis" />
          <label class="inline" style="margin-top: 8px;">
            <input id="bannerEnabledInput" type="checkbox" />
            Aktiver topbanner
          </label>
          <label class="inline" style="margin-top: 6px;">
            <input id="notifyEnabledInput" type="checkbox" />
            Vis notifications-ikon (topbar)
          </label>
          <label style="margin-top: 8px;">Topbanner beskeder</label>
          <textarea id="bannerMessagesInput" rows="3" placeholder="Skriv fælles beskeder..."></textarea>
          <label style="margin-top: 8px;">Standard model</label>
          <select id="modelSelectAdmin"></select>
          <button id="saveModelBtn" class="secondary" style="margin-top: 8px;">Gem model</button>
          <button id="renameChatsBtn" class="secondary" style="margin-top: 8px;">Opdater chat-navne</button>
          <label style="margin-top: 8px;">Public base URL (til download‑links)</label>
          <input id="publicBaseUrlInput" placeholder="http://localhost:8000" />
          <button id="saveFooterBtn" class="secondary" style="margin-top: 8px;">Gem indstillinger</button>
          <div class="small" id="footerStatus"></div>

          <div class="session-group-title" style="margin-top: 12px;">.env</div>
          <textarea id="envEditor" rows="8" placeholder="KEY=value"></textarea>
          <button id="saveEnvBtn" class="secondary" style="margin-top: 8px;">Gem .env</button>
          <div class="small" id="envStatus"></div>
        </section>

        <section class="card" id="panel-tickets">
          <div class="card-row">
            <h2>Tickets</h2>
            <button id="refreshTicketsBtn" class="secondary">Opdater</button>
          </div>
          <div id="ticketsAdminList"></div>
          <div class="card" id="ticketAdminDetail" style="display:none; margin-top: 10px;">
            <h3 id="ticketAdminTitle">Ticket</h3>
            <div class="small" id="ticketAdminMeta"></div>
            <label>Status</label>
            <select id="ticketAdminStatus">
              <option value="open">open</option>
              <option value="in_progress">in_progress</option>
              <option value="fixed">fixed</option>
              <option value="closed">closed</option>
            </select>
            <label>Prioritet</label>
            <select id="ticketAdminPriority">
              <option value="vigtig">vigtig</option>
              <option value="moderat">moderat</option>
              <option value="kritisk">kritisk</option>
            </select>
            <button id="ticketAdminSave" class="secondary" style="margin-top: 8px;">Gem status</button>
            <label style="margin-top: 8px;">Svar</label>
            <textarea id="ticketAdminReply" rows="3"></textarea>
            <button id="ticketAdminReplyBtn" class="secondary" style="margin-top: 8px;">Send svar</button>
            <div class="small" id="ticketAdminMessages"></div>
          </div>
        </section>

        <section class="card" id="panel-logs">
          <div class="card-row">
            <h2>Logs</h2>
            <button id="refreshLogsBtn" class="secondary">Opdater</button>
          </div>
          <div id="logFiles"></div>
          <label style="margin-top: 8px;">Log-udsnit</label>
          <textarea id="logContent" rows="10" readonly></textarea>
        </section>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <span id="footerText">Jarvis v.1 @ 2026</span>
    <span class="footer-links">
      <a id="footerSupport" href="#">Support</a>
      <a id="footerContact" href="#">Kontakt</a>
      <a id="footerLicense" href="#">Open‑source licens</a>
    </span>
  </footer>

  <script src="/static/auth.js?v=9"></script>
  <script src="/static/api.js"></script>
  <script src="/static/admin.js?v=9"></script>
</body>
</html>
